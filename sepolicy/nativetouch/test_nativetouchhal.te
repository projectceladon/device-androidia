#
# nativetouch_hal
#

# Rules for hardware/intel/nativetouch/helper
type test_nativetouchhal, domain;
type test_nativetouchhal_exec, exec_type, file_type, vendor_file_type;
init_daemon_domain(test_nativetouchhal)

hal_client_domain(test_nativetouchhal, hal_nativetouch)

# no need to complain about denied access
# as it will clutter the log when probing
# all /proc/<pid> where it cannot search/open/read
dontaudit test_nativetouchhal domain:dir search;

# allow to set property ctl.nativetouch_hal.*
set_prop(test_nativetouchhal, vendor_nativetouch_hal_prop)
get_prop(test_nativetouchhal, exported_system_prop)

allow shell test_nativetouchhal_exec:file getattr;
allow hal_nativetouch_service property_socket:sock_file write;
#allow hal_nativetouch_service property_socket:sock_file read;
#allow test_nativetouchhal system_prop:file read;
unix_socket_connect(hal_nativetouch_service, property, init)
